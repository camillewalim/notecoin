# Notecoin - Mark II
![](https://github.com/camillewalim/notecoin/blob/mark-i-base/static/notecoin_logo.PNG)

## How to run the binaries
### Pre-requirements
* being in 'pass' or 'final' branch *(as we follow TDD, 'fail' branches are commited first, and then come the implementation to let the test pass)*
* java 1.8 installed and path-referenced from windows system/user variables.
* any .sh console installed that let you run this file run.sh

### Instructions
* Open the [/bin/run.sh](https://github.com/camillewalim/notecoin/tree/mark-ii-base/bin) file in your console
* This would open two windows per local server : one logging console, one web browser.

## How to audit the assignement ? What are Mk-I, Mk-II, Mk-III ?
### Philosophy
In my opinion, Simplicity and Sophistication are two contradictory approaches. The first brings you fast-development & low costs; the second high-added value service and scalability. I'm agnostic in that balance, and I usually scale the sophistication as per the client needs (through workshops, feedbacks & agile).

As this is an open exercise, bounded in time, and I do not have a direct access to all reviewers, here is git to help :
The three versions are properly linked through git history, so you could see the evolution of features (through TDD of course), and judge my ability to scale up a service from POC to a more advanced user-centric product.

Just plug yourself to the [level of sophistication you favor](https://github.com/camillewalim/notecoin/network):

![git network](https://github.com/camillewalim/notecoin/blob/mark-i-base/static/github_network.PNG)

The naming logic being : Mk-[v]_[f]-[t]
* [v] being the version ('I', 'II', 'III')
* [f] a particular feature or the final branch for a given version
* [t] being the test status of the commit ('fail' then 'pass')

### Mk-I : just the specifications
#### Goal
To strictly respect the specifications, with the minimum assumptions and no personal initiatives.

#### Assumptions, Solutions, Limits
| **subject**                                                                                                                         | **specification (by quote)**                                                                                                                   | **solution**                                                                                                                                                                                                                               | **limit**                                                                                                                                                                                                                                                                                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [:wrench:   base-java](https://github.com/camillewalim/notecoin/pull/mark-i-base-pass)                                             | *"Java for the backend and HTML5 for the frontend"*                                                                                            | Java 1.8, Lombok, Spring Boot 2.2, H2 1.4                                                                                                                                                                                                  | :x: a bit verbose, not state-of-the-art, leverage on   Java-Agent (lombok) that could be buggy                                                                                                                                                                                                                                          |
| [:wrench:   base-ui](https://github.com/camillewalim/notecoin/pull/mark-i-base-pass)                                               | *"a very simple UI or even no UI is fine"*                                                                                                     | Swagger UI                                                                                                                                                                                                                                 | :x: no user-friendly way to interact with the application,   (curl & swagger being mostly used by devs)                                                                                                                                                                                                                                 |
| [:wrench:   base-oo](https://github.com/camillewalim/notecoin/pull/mark-i-base-pass)                                               | *"OO Design [...] and the coding technique"*                                                                                                   | 3-Tier dependency-injection application (with REST, Stream,   JPA) + Flyway                                                                                                                                                                | :heavy_dollar_sign: for a 3-Tier + Flyway, but   :heavy_check_mark:  get easy   loose-coupling & migrability                                                                                                                                                                                                                            |
| [:wrench:   base-tdd](https://github.com/camillewalim/notecoin/pull/mark-i-base-pass)                                              | *"practice of TDD"*                                                                                                                            | Mockito & Junit for : <br>- unit-testing (UT) : transactionality of (service) operations <br>- integration-testing (IT) : availability & integration of rest (controller) operations   | :heavy_dollar_sign: for a TDD approach , but   :heavy_check_mark:  get non-regression,   stability & safety                                                                                                                                                                                                                             |
| [:floppy_disk:   feature-inventory-name](https://github.com/camillewalim/notecoin/pull/mark-i-feature-inventory-name-pass)         | *"An Inventory has name [...]"*                                                                                                                | one pojo, one model for : inventory_name                                                                                                                                                                                                   | :x: no data associated with each product (just a name)                                                                                                                                                                                                                                                                                  |
| [:floppy_disk:   feature-inventory-category](https://github.com/camillewalim/notecoin/pull/mark-i-feature-inventory-category-pass) | *"category, sub-category [...] some validation rules when   creating an inventory, eg. a sub-category "Shoe" should not in   category "Food""* | <br>- one pojo, one model for :   inventory_category.      <br>- Two relationships: category -> (sub) category, category   -> product                                                                                                      | :x: the inheritance relation "category -> (sub)   category" only holds from a DB perspective and field perspective, not   from a type-safe perspective.       <br> This lack of type-safety forces us to maintain a validation rule   for such relation during the whole lifecycle (error-prone and risky)                              |
| [:floppy_disk:   feature-inventory-quantity](https://github.com/camillewalim/notecoin/pull/mark-i-feature-inventory-quantity-pass) | *"[...] quantity information'"*                                                                                                                | one pojo, one model for : inventory_quantity                                                                                                                                                                                               | :x: mutable data (not auditable once the quantity has   changed), no transaction information, very naïve & basic accounting model   (what about receivables & payables ?)                                                                                                                                                               |
| [:recycle:   feature-create](https://github.com/camillewalim/notecoin/pull/mark-i-feature-create-pass)                             | *"to create Inventory [...]"*                                                                                                                  | one REST endpoint, one service that directly modifies   inventory_name & inventory_category CRUDs                                                                                                                                          | :x: confusing role there :       <br> is the door an admin one (in charge of creating a cat/sub   cat/product hierarchy)?       <br> an inventory owner one (in charge of creating an   inventory)?      <br> a trader one (in charge of creating an inventory after an   attempt to give some inventory to a non-referenced product) ? |
| [:recycle:   feature-update](https://github.com/camillewalim/notecoin/pull/mark-i-feature-update-pass)                             | *"update the quantity"*                                                                                                                        | one REST endpoint, one service that directly modifies   inventory_quantity CRUD                                                                                                                                                            | :x: low-level endpoint to set an application state (the   quantity) without any concern about the user nature (admin, owner, trader) or   intent (buying, selling, booking, releasing, etc)                                                                                                                                             |
| [:recycle:   feature-browse](https://github.com/camillewalim/notecoin/pull/mark-i-feature-browse-pass)                             | *"browse the Inventory records"*                                                                                                               | one REST endpoint, one service that will provide the list of   all inventory positions                                                                                                                                                     | :x: performance consuming (make a big db dump) and not really   fit to the user nature or intent again(listing inventory, getting a given   quantity for a potential taking, etc.)                                                                                                                                                      |                                                              |

### Mk-II : from piece of code to user-centric product
#### Goal
To interpret the specifications by making some assumptions about the user needs and make the product user-centric.

This process goes through a more Domain-Driven approach, decoupling controllers (providing features to the user) from services (manipulating application data), renaming classes & packages, etc.

#### Assumptions, Solutions, Limits
| **subject   changed**                                                                                                               | **additional assumption**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | **solution change**                                                                                                                                                                                                                                                                         | **limit change**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [:floppy_disk:   feature-inventory-name](https://github.com/camillewalim/notecoin/pull/mark-ii-feature-inventory-name-pass)         | - an inventory is a collection of products <br>- so we could extends its design with new properties about them. <br> Ex: a banana is not only a "banana" but has also some color,   weight, height, origin, etc.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | - "inventory_name" becomes   "product".       <br>- All products have a set of common properties (creation_date,   origin, etc.) <br>-... and some category_details (being a polymorphic object) that is stored as jsonb in DB.                                                  | :heavy_dollar_sign: for a mix DB design (sql & no-sql at   same time), but H2 & Postgres now supporting this mix nature get :      <br> :heavy_check_mark: the capability to have details attached to a   product that are queryable through sql lemmes in O(1) time (through   indexation)      <br> :heavy_check_mark: serializable java polymorphism as a json   field queryable through no-sql lemme.       <br> :x: mixed do not mean interchangeable: no-sql is long to query,   and sql is not easily updatable (need a migration with Flyway)                           |
| [:floppy_disk:   feature-inventory-category](https://github.com/camillewalim/notecoin/pull/mark-ii-feature-inventory-category-pass) | category and sub-category is a taxonomy and by   definition :        - as it is recursive it could be   infinitely long.       <br>- it represents objects that inherit   some properties   <br><br>-    2 situations could come then :       <br><br>- this categorisation is the result of property inheritance (all bananas   have all the fruit's properties) and therefore this inheritance logic is   coded through Java polymorphism.      <br><br>- this categorisation is arbitrary (a user decided it) : and the DB is   responsible to store this relation.    <br><br>   The two situations cohabitate together. Users are allowed to create   as many arbitrary categories as they want as long as they do not contradict   the existing hard-coded java polymorphism. | - "inventory category" becames   "product_class".      <br>- creation of new types of product_class (for illustration) :   Vegetable, Tuber, Potatoe, SweetPotatoe, etc…                                                                                                                | :heavy_dollar_sign: for a mix object-inheritance design (in DB   & code at same time), but get :      <br> :heavy_check_mark: type-safety and dry (*do not repeat   yourself*) pattern for polymorphic objects.      <br> :heavy_check_mark: ... and still keep the dynamic feature of   user creating categories at run-time (that could still be catched up later by   the dev team and incorporated in code)      <br> :x: flexible do not mean magic. If a user wants to associate new   properties with a given category, he needs to dev team to code a class for   that. |
| [:floppy_disk:   feature-inventory-quantity](https://github.com/camillewalim/notecoin/pull/mark-ii-feature-inventory-quantity-pass) | quantity represents a given quantified ownership of a product   (and the owner and the status of this ownership should be marked).      <br><br> In addition, as this is a highly mutable & demanded data,   the risk of performance bottleneck is very high, and the absence of   auditability is annoying.      <br><br> In addition, in order to be able to book some product quantity   for a short amount of time  (to take it   later), we need to have 4 kind of order (take, give, lend, borrow).      <br><br> As the current quantity is just the result of the past orders,   we should therefore convert that into a list of orders.                                                                                                                                                                                                                                              | <br>- "inventory quantity" becames   "orders".      <br>- order gain new properties : date, nature (taken, given,   receivable, payable), maturity(null for "taken" &   "given").                                                                                                           | :heavy_dollar_sign: for an event-driven model, but get :      <br> :heavy_check_mark: immutable data model, so auditable &   replayable (if service down)      <br> :heavy_check_mark: transaction information included      <br> :heavy_check_mark: realistic accounting model (with payables   & receivables) that let the system to handle a variety of situations   (borrowing, pre-order or booking, short-sell, etc.)                                                                                                                                                     |
| [:recycle:   feature-create](https://github.com/camillewalim/notecoin/pull/mark-ii-feature-create-pass)                             | need to conform to new model : Mk-II-   feature-inventory-category                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | - rename createInventory -> createProductClass      <br>- we need to add precondition to control the contradictions   between user inputs and existing taxonomy.                                                                                                                            | :x: same than Mk-I *(about roles seggregation)*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [:recycle:   feature-update](https://github.com/camillewalim/notecoin/pull/mark-ii-feature-update-pass)                             | need to conform to new model : Mk-II-   feature-inventory-quantity                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | - split updateQuantity endpoint to : giveProduct, takeProduct,   lendProduct, borrowProduct.      <br>- a running position of each product should be cached into the   service Trader, that would check for each order before to "execute   it" (so store it in DB) and returns status code | :heavy_dollar_sign: for a state (the running product position)   inside the server (but that could be replayable out of DB), but get :      <br> :heavy_check_mark: internalization of bottleneck (the current   position) from DB to API (where we have much more coding tools to manage   it)      <br>: the user do not need to care about low-level operation anymore   (update the quantity) but could find a service for its need (take, give,   borrow, lend).                                                                                                           |
| [:recycle:   feature-browse](https://github.com/camillewalim/notecoin/pull/mark-ii-feature-browse-pass)                             | need to conform to new service :  Mk-II-feature-trade                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | - the current position should be retrieved from the API and not   the DB     <br>  <br> - creating one more endpoint to get the list of all orders from DB   (to browse them, as we decorrelated them from positions)                                                                                | :heavy_dollar_sign: for a state (the running product position)   inside the server (but that could be replayable out of DB), but get :      <br> :heavy_check_mark: internalization of performance issue (the   current position) from DB to API (where we have much more coding tools to   manage it)      <br> <br>  :x: (from   Mk-I) -> still really not fit to the user nature or intent again(listing   inventory, getting a given quantity for a potential taking, etc.)                                                                                                |
